<?xml version="1.0" encoding="UTF-8"?>
<jasperReport xmlns="http://jasperreports.sourceforge.net/jasperreports" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://jasperreports.sourceforge.net/jasperreports http://jasperreports.sourceforge.net/xsd/jasperreport.xsd" name="report name" pageWidth="792" pageHeight="612" orientation="Landscape" columnWidth="752" leftMargin="20" rightMargin="20" topMargin="20" bottomMargin="20">
	<property name="ireport.zoom" value="0.9090909090909095"/>
	<property name="ireport.x" value="0"/>
	<property name="ireport.y" value="0"/>
	<parameter name="p_schema" class="java.lang.String"/>
	<parameter name="p_titulo" class="java.lang.String"/>
	<parameter name="p_dirbase" class="java.lang.String"/>
	<queryString>
		<![CDATA[SELECT
P.nompre,referencia,descripcion,tipo,fecha,cedrif,nomben,estat,codigo,imputado,comprometido,causado,pagado,Ajuste,Mon_Aju, monto
FROM (SELECT
A.refcau as referencia,
RTRIM(A.descau)as descripcion,
A.tipcau as tipo,
to_char(A.feccau,'dd/mm/yyyy') as fecha,
A.CEDRIF as cedrif,
a.stacau as estat,
RTRIM(B.CodPre ) as codigo,
B.monimp as imputado,
B.monimp as comprometido,
B.monIMP as causado,

(SELECT SUM(S.MONIMP) FROM $P!{p_schema}.CPpagos R,$P!{p_schema}.CPimppag S WHERE S.REFere=B.REFCau AND S.CODPRE=B.CODPRE AND S.REFpag=R.REFpag AND  R.FECpag>=TO_DATE('06/01/2012','DD/MM/YYYY') AND R.FECpag<=TO_DATE('09/02/2012','DD/MM/YYYY') and (R.STApag='A' OR (R.STApag='N' AND R.FECANU>=TO_DATE('09/02/2012','DD/MM/YYYY')))) as pagado,								
(SELECT SUM(y.MONAJU) FROM $P!{p_schema}.CPAJUSTE X, $P!{p_schema}.CPMOVAJU Y, $P!{p_schema}.CPDOCAJU Z WHERE X.REFERE=B.REFCAU AND Y.CODPRE=B.CODPRE AND x.refaju=y.refaju AND X.TIPAJU=Z.TIPAJU AND  Z.REFIER='A' AND  X.FECAJU>=to_date('06/01/2012','dd/mm/yyyy') and X.FECAJU<=to_date('09/02/2012','dd/mm/yyyy') and (X.STAAJU='A' OR (X.STAAJU='N' AND X.FECANU >to_date('09/02/2012','dd/mm/yyyy'))) ) as Ajuste,
				(B.monimp-B.monaju) as Mon_Aju, c.nomben,   	  a.moncau as monto
				FROM
				$P!{p_schema}.CPCAUSAD as A left outer join $P!{p_schema}.opbenefi C on A.CEDRIF=C.CEDRIF,
				$P!{p_schema}.CPIMPCAU as B,
				$P!{p_schema}.CPDOCCAU as D
				WHERE
				A.TIPCAU=D.TIPCAU AND RTRIM(D.AFECAU)='S'
                AND A.REFCAU = B.REFCAU
				AND (A.REFCAU)>=RTRIM('00000002') AND (A.REFCAU) <=RTRIM('00000218')
				AND (B.CODPRE >=RTRIM('1-01-005-4-01-01-01-00-001-01-005-4-01-01-01-00-00') AND B.CODPRE<=RTRIM('4-01-008-4-07-01-01-12-004-01-008-4-07-01-01-12-00'))
				 AND A.FECCAU>=to_date('06/01/2012','dd/mm/yyyy') AND A.FECCAU <=to_date('09/02/2012','dd/mm/yyyy') AND (A.STACAU='A' OR (A.STACAU='N' AND A.FECANU>=to_date('09/02/2012','dd/mm/yyyy'))) 
				UNION
				SELECT
				A.refpag as referencia,
				RTRIM(A.despag)as descripcion,
				A.tippag as tipo,
				to_char(A.fecpag,'dd/mm/yyyy') as fecha,
				A.CEDRIF as cedrif,
				a.stapag as estat,
				RTRIM(B.CodPre ) as codigo,
				B.monimp as imputado,
				B.monimp as comprometido,
				B.monIMP as causado,
				B.monIMP as pagado,
				(SELECT SUM(y.MONAJU) 
				   FROM $P!{p_schema}.CPAJUSTE X, $P!{p_schema}.CPMOVAJU Y, $P!{p_schema}.CPDOCAJU Z
			      WHERE X.REFERE=B.REFPAG AND 
				  Y.CODPRE=B.CODPRE AND 
				  x.refaju=y.refaju AND
				  X.TIPAJU=Z.TIPAJU AND 
				  Z.REFIER='G' AND 
				  X.FECAJU>=to_date('06/01/2012','dd/mm/yyyy') and X.FECAJU<=to_date('09/02/2012','dd/mm/yyyy') 
				  and (X.STAAJU='A' OR (X.STAAJU='N' AND X.FECANU >to_date('09/02/2012','dd/mm/yyyy'))) ) as Ajuste,
				(B.monimp-B.monaju) as Mon_Aju, c.nomben,   	  a.monpag as monto
				FROM
				$P!{p_schema}.CPPAGOS as A left outer join $P!{p_schema}.opbenefi C on A.CEDRIF=C.CEDRIF,
				$P!{p_schema}.CPIMPPAG as B,
				$P!{p_schema}.CPDOCPAG as D
				WHERE
				A.TIPPAG=D.TIPPAG
				AND RTRIM(D.AFECAU)='S'
                AND A.REFPAG = B.REFPAG
                AND (B.CODPRE >=RTRIM('1-01-005-4-01-01-01-00-001-01-005-4-01-01-01-00-00') AND B.CODPRE<=RTRIM('4-01-008-4-07-01-01-12-004-01-008-4-07-01-01-12-00'))
                  AND A.FECPAG>=to_date('06/01/2012','dd/mm/yyyy') AND A.FECPAG <=to_date('09/02/2012','dd/mm/yyyy') AND (A.STAPAG='A' OR (A.STAPAG='N' AND A.FECANU>=to_date('09/02/2012','dd/mm/yyyy')))   ORDER BY fecha,referencia asc,codigo,estat
                ) as J left outer join $P!{p_schema}.CPDEFTIT P on (RTRIM(J.CODIGO)=RTRIM(P.CODPRE))]]>
	</queryString>
	<field name="nompre" class="java.lang.String"/>
	<field name="referencia" class="java.lang.String"/>
	<field name="descripcion" class="java.lang.String"/>
	<field name="tipo" class="java.lang.String"/>
	<field name="fecha" class="java.lang.String"/>
	<field name="cedrif" class="java.lang.String"/>
	<field name="nomben" class="java.lang.String"/>
	<field name="estat" class="java.lang.String"/>
	<field name="codigo" class="java.lang.String"/>
	<field name="imputado" class="java.math.BigDecimal"/>
	<field name="comprometido" class="java.math.BigDecimal"/>
	<field name="causado" class="java.math.BigDecimal"/>
	<field name="pagado" class="java.math.BigDecimal"/>
	<field name="ajuste" class="java.math.BigDecimal"/>
	<field name="mon_aju" class="java.math.BigDecimal"/>
	<field name="monto" class="java.math.BigDecimal"/>
	<variable name="estatus" class="java.lang.String">
		<variableExpression><![CDATA[( $F{estat}.equals( "A" ) ? "Activo" : "Inactivo" )]]></variableExpression>
	</variable>
	<variable name="causado_1" class="java.math.BigDecimal" resetType="Group" resetGroup="orpag" calculation="Sum">
		<variableExpression><![CDATA[$F{causado}]]></variableExpression>
	</variable>
	<variable name="pagado_1" class="java.math.BigDecimal" resetType="Group" resetGroup="orpag" calculation="Sum">
		<variableExpression><![CDATA[$F{pagado}]]></variableExpression>
	</variable>
	<variable name="ajuste_1" class="java.math.BigDecimal" resetType="Group" resetGroup="orpag" calculation="Sum">
		<variableExpression><![CDATA[$F{ajuste}]]></variableExpression>
	</variable>
	<variable name="mon_aju_1" class="java.math.BigDecimal" resetType="Group" resetGroup="orpag" calculation="Sum">
		<variableExpression><![CDATA[$F{mon_aju}]]></variableExpression>
	</variable>
	<variable name="causado_2" class="java.math.BigDecimal" calculation="Sum">
		<variableExpression><![CDATA[$F{causado}]]></variableExpression>
	</variable>
	<variable name="pagado_2" class="java.math.BigDecimal" calculation="Sum">
		<variableExpression><![CDATA[$F{pagado}]]></variableExpression>
	</variable>
	<variable name="ajuste_2" class="java.math.BigDecimal" resetType="Page" calculation="Sum">
		<variableExpression><![CDATA[$F{ajuste}]]></variableExpression>
	</variable>
	<variable name="mon_aju_2" class="java.math.BigDecimal" calculation="Sum">
		<variableExpression><![CDATA[$F{mon_aju}]]></variableExpression>
	</variable>
	<variable name="ajuste" class="java.lang.String">
		<variableExpression><![CDATA[$F{ajuste}]]></variableExpression>
	</variable>
	<variable name="ajuste_3" class="java.math.BigDecimal" resetType="Group" resetGroup="orpag" calculation="Sum">
		<variableExpression><![CDATA[$F{ajuste}]]></variableExpression>
	</variable>
	<group name="orpag">
		<groupExpression><![CDATA[$F{referencia}]]></groupExpression>
		<groupHeader>
			<band height="50">
				<textField>
					<reportElement x="13" y="0" width="78" height="30"/>
					<textElement>
						<font isBold="true"/>
					</textElement>
					<textFieldExpression><![CDATA[$F{referencia}]]></textFieldExpression>
				</textField>
				<textField>
					<reportElement x="104" y="0" width="71" height="30"/>
					<textElement>
						<font isBold="true"/>
					</textElement>
					<textFieldExpression><![CDATA[$F{tipo}]]></textFieldExpression>
				</textField>
				<textField>
					<reportElement x="189" y="0" width="68" height="30"/>
					<textElement>
						<font isBold="true"/>
					</textElement>
					<textFieldExpression><![CDATA[$F{fecha}]]></textFieldExpression>
				</textField>
				<textField>
					<reportElement x="270" y="0" width="194" height="30"/>
					<textElement>
						<font isBold="true"/>
					</textElement>
					<textFieldExpression><![CDATA[$F{descripcion}]]></textFieldExpression>
				</textField>
				<textField>
					<reportElement x="483" y="0" width="138" height="30"/>
					<textElement>
						<font isBold="true"/>
					</textElement>
					<textFieldExpression><![CDATA[$F{nomben}]]></textFieldExpression>
				</textField>
				<textField>
					<reportElement x="636" y="0" width="100" height="20"/>
					<textElement>
						<font isBold="true"/>
					</textElement>
					<textFieldExpression><![CDATA[( $F{estat}.equals( "A" ) ? "Activo" : "Inactivo" )]]></textFieldExpression>
				</textField>
			</band>
		</groupHeader>
		<groupFooter>
			<band height="28">
				<staticText>
					<reportElement x="367" y="0" width="40" height="20"/>
					<textElement/>
					<text><![CDATA[Monto]]></text>
				</staticText>
				<textField>
					<reportElement x="427" y="0" width="78" height="20"/>
					<textElement/>
					<textFieldExpression><![CDATA[$V{causado_1}]]></textFieldExpression>
				</textField>
				<textField>
					<reportElement x="509" y="0" width="69" height="20"/>
					<textElement/>
					<textFieldExpression><![CDATA[$V{pagado_1}]]></textFieldExpression>
				</textField>
				<textField>
					<reportElement x="667" y="0" width="71" height="20"/>
					<textElement/>
					<textFieldExpression><![CDATA[$V{mon_aju_1}]]></textFieldExpression>
				</textField>
				<line>
					<reportElement x="2" y="22" width="750" height="1"/>
				</line>
				<line>
					<reportElement x="367" y="-7" width="383" height="1"/>
				</line>
				<textField>
					<reportElement x="594" y="0" width="58" height="20"/>
					<textElement/>
					<textFieldExpression><![CDATA[( $V{ajuste_3}==null ? 0.0 : $V{ajuste_3} )]]></textFieldExpression>
				</textField>
			</band>
		</groupFooter>
	</group>
	<background>
		<band splitType="Stretch"/>
	</background>
	<pageHeader>
		<band height="143" splitType="Stretch">
			<textField>
				<reportElement x="621" y="20" width="80" height="20"/>
				<textElement textAlignment="Right"/>
				<textFieldExpression><![CDATA["Página "+$V{PAGE_NUMBER}+" de"]]></textFieldExpression>
			</textField>
			<textField evaluationTime="Report">
				<reportElement x="701" y="20" width="40" height="20"/>
				<textElement/>
				<textFieldExpression><![CDATA[" " + $V{PAGE_NUMBER}]]></textFieldExpression>
			</textField>
			<textField pattern="dd/MM/yyyy">
				<reportElement x="677" y="0" width="100" height="20"/>
				<textElement/>
				<textFieldExpression><![CDATA[new java.util.Date()]]></textFieldExpression>
			</textField>
			<staticText>
				<reportElement x="104" y="0" width="343" height="40"/>
				<textElement>
					<font size="12" isBold="true"/>
				</textElement>
				<text><![CDATA[REPÚBLICA BOLIVARIANA DE VENEZUELA
La Nueva Televisión del Sur, C.A.]]></text>
			</staticText>
			<staticText>
				<reportElement x="273" y="117" width="348" height="20"/>
				<textElement textAlignment="Center" verticalAlignment="Middle">
					<font isBold="true"/>
				</textElement>
				<text><![CDATA[Desde 01/01/2012 Hasta 01/02/2012   ddddddddd]]></text>
			</staticText>
			<line>
				<reportElement x="0" y="116" width="752" height="1"/>
			</line>
			<line>
				<reportElement x="0" y="138" width="752" height="1"/>
			</line>
			<staticText>
				<reportElement x="636" y="0" width="41" height="20"/>
				<textElement/>
				<text><![CDATA[Fecha:]]></text>
			</staticText>
			<image>
				<reportElement x="4" y="0" width="90" height="103"/>
				<imageExpression><![CDATA[$P{p_dirbase} + "/img/logo_1.jpg"]]></imageExpression>
			</image>
			<textField>
				<reportElement x="270" y="83" width="207" height="20"/>
				<textElement textAlignment="Center" verticalAlignment="Middle">
					<font size="14" isBold="true"/>
				</textElement>
				<textFieldExpression><![CDATA[$P{p_titulo}]]></textFieldExpression>
			</textField>
		</band>
	</pageHeader>
	<columnHeader>
		<band height="137" splitType="Stretch">
			<staticText>
				<reportElement x="13" y="21" width="78" height="14"/>
				<textElement>
					<font isBold="true"/>
				</textElement>
				<text><![CDATA[Referencia]]></text>
			</staticText>
			<staticText>
				<reportElement x="104" y="21" width="71" height="14"/>
				<textElement>
					<font isBold="true"/>
				</textElement>
				<text><![CDATA[Tipo]]></text>
			</staticText>
			<staticText>
				<reportElement x="189" y="21" width="68" height="14"/>
				<textElement>
					<font isBold="true"/>
				</textElement>
				<text><![CDATA[Fecha]]></text>
			</staticText>
			<staticText>
				<reportElement x="270" y="21" width="194" height="14"/>
				<textElement>
					<font isBold="true"/>
				</textElement>
				<text><![CDATA[Descripción]]></text>
			</staticText>
			<staticText>
				<reportElement x="483" y="21" width="138" height="14"/>
				<textElement>
					<font isBold="true"/>
				</textElement>
				<text><![CDATA[Beneficiario]]></text>
			</staticText>
			<staticText>
				<reportElement x="636" y="21" width="116" height="20"/>
				<textElement>
					<font isBold="true"/>
				</textElement>
				<text><![CDATA[Estatus]]></text>
			</staticText>
			<staticText>
				<reportElement x="94" y="55" width="163" height="20"/>
				<textElement>
					<font isBold="true"/>
				</textElement>
				<text><![CDATA[Imputaciones Presupuestarias]]></text>
			</staticText>
			<staticText>
				<reportElement x="427" y="55" width="58" height="20"/>
				<textElement>
					<font isBold="true"/>
				</textElement>
				<text><![CDATA[Causado]]></text>
			</staticText>
			<staticText>
				<reportElement x="509" y="56" width="51" height="20"/>
				<textElement>
					<font isBold="true"/>
				</textElement>
				<text><![CDATA[Pagado]]></text>
			</staticText>
			<staticText>
				<reportElement x="594" y="55" width="42" height="20"/>
				<textElement>
					<font isBold="true"/>
				</textElement>
				<text><![CDATA[Ajuste]]></text>
			</staticText>
			<staticText>
				<reportElement x="652" y="55" width="100" height="20"/>
				<textElement>
					<font isBold="true"/>
				</textElement>
				<text><![CDATA[Monto Ajustado]]></text>
			</staticText>
			<line>
				<reportElement x="0" y="75" width="752" height="1"/>
			</line>
		</band>
	</columnHeader>
	<detail>
		<band height="47" splitType="Stretch">
			<textField>
				<reportElement x="2" y="2" width="149" height="34"/>
				<textElement/>
				<textFieldExpression><![CDATA[$F{codigo}]]></textFieldExpression>
			</textField>
			<textField>
				<reportElement x="172" y="0" width="100" height="36"/>
				<textElement/>
				<textFieldExpression><![CDATA[$F{nompre}]]></textFieldExpression>
			</textField>
			<textField>
				<reportElement x="427" y="0" width="80" height="20"/>
				<textElement/>
				<textFieldExpression><![CDATA[$F{causado}]]></textFieldExpression>
			</textField>
			<textField>
				<reportElement x="509" y="0" width="69" height="20"/>
				<textElement/>
				<textFieldExpression><![CDATA[$F{pagado}]]></textFieldExpression>
			</textField>
			<textField>
				<reportElement x="667" y="0" width="71" height="20"/>
				<textElement/>
				<textFieldExpression><![CDATA[$F{mon_aju}]]></textFieldExpression>
			</textField>
			<textField>
				<reportElement x="594" y="0" width="58" height="20"/>
				<textElement/>
				<textFieldExpression><![CDATA[( $F{ajuste}==null ? 0.0 : $F{ajuste} )]]></textFieldExpression>
			</textField>
		</band>
	</detail>
	<columnFooter>
		<band height="45" splitType="Stretch"/>
	</columnFooter>
	<pageFooter>
		<band height="54" splitType="Stretch"/>
	</pageFooter>
	<summary>
		<band height="42" splitType="Stretch">
			<textField>
				<reportElement x="427" y="0" width="80" height="20"/>
				<textElement/>
				<textFieldExpression><![CDATA[$V{causado_2}]]></textFieldExpression>
			</textField>
			<textField>
				<reportElement x="509" y="0" width="69" height="20"/>
				<textElement/>
				<textFieldExpression><![CDATA[$V{pagado_2}]]></textFieldExpression>
			</textField>
			<textField>
				<reportElement x="594" y="0" width="60" height="20"/>
				<textElement/>
				<textFieldExpression><![CDATA[$V{ajuste_2}]]></textFieldExpression>
			</textField>
			<textField>
				<reportElement x="667" y="0" width="69" height="20"/>
				<textElement/>
				<textFieldExpression><![CDATA[$V{mon_aju_2}]]></textFieldExpression>
			</textField>
			<staticText>
				<reportElement x="257" y="0" width="100" height="20"/>
				<textElement textAlignment="Center" verticalAlignment="Middle">
					<font isBold="true"/>
				</textElement>
				<text><![CDATA[Totales:]]></text>
			</staticText>
		</band>
	</summary>
</jasperReport>
