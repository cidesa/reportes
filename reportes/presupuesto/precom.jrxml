<?xml version="1.0" encoding="UTF-8"?>
<jasperReport xmlns="http://jasperreports.sourceforge.net/jasperreports" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://jasperreports.sourceforge.net/jasperreports http://jasperreports.sourceforge.net/xsd/jasperreport.xsd" name="report name" pageWidth="792" pageHeight="612" orientation="Landscape" columnWidth="752" leftMargin="20" rightMargin="20" topMargin="20" bottomMargin="20">
	<property name="ireport.zoom" value="1.0"/>
	<property name="ireport.x" value="0"/>
	<property name="ireport.y" value="0"/>
	<parameter name="p_schema" class="java.lang.String"/>
	<parameter name="p_titulo" class="java.lang.String"/>
	<parameter name="p_dirbase" class="java.lang.String"/>
	<queryString>
		<![CDATA[SELECT

               P.nompre,
               referencia,
               descripcion,
               tipo,
               fecha,
               cedrif,nomben,
               estat,
               codigo,
               imputado,
               comprometido,
               causado,
               pagado,
               Ajuste,
               Mon_Aju, monto
               FROM (SELECT
                A.refcom as referencia,
                RTRIM(A.descom) as descripcion,
                A.tipcom as tipo,
                to_char(A.feccom,'DD/MM/YYYY') as fecha,
                A.CEDRIF as cedrif,
                a.stacom as estat,
                RTRIM(B.CodPre) as codigo,
                B.monimp as imputado,
                B.monimp as comprometido,
(SELECT SUM(S.MONIMP) FROM "SIMA005".CPCAUSAD R,"SIMA005".CPIMPCAU S WHERE S.REFERE=B.REFCOM AND S.CODPRE=B.CODPRE AND S.REFCAU=R.REFCAU AND  R.FECCAU>=TO_DATE('02/01/2012','DD/MM/YYYY') AND R.FECCAU<=TO_DATE('09/02/2012','DD/MM/YYYY') and (R.STACAU='A' OR (R.STACAU='N' AND R.FECANU>=TO_DATE('09/02/2012','DD/MM/YYYY')))) as causado,
(SELECT SUM(S.MONIMP) FROM "SIMA005".CPpagos R,"SIMA005".CPimppag S WHERE S.REFcom=B.REFCOM AND S.CODPRE=B.CODPRE AND S.REFpag=R.REFpag AND  R.FECpag>=TO_DATE('02/01/2012','DD/MM/YYYY') AND R.FECpag<=TO_DATE('09/02/2012','DD/MM/YYYY') and (R.STApag='A' OR (R.STApag='N' AND R.FECANU>=TO_DATE('09/02/2012','DD/MM/YYYY')))) as pagado,				
(SELECT SUM(Y.MONAJU) FROM "SIMA005".CPAJUSTE X,"SIMA005".CPMOVAJU Y,"SIMA005".CPDOCAJU Z WHERE X.REFERE=B.REFCOM AND Y.CODPRE=B.CODPRE AND X.REFAJU=Y.REFAJU AND  X.TIPAJU=Z.TIPAJU AND Z.REFIER='C' AND X.FECAJU>=TO_DATE('02/01/2012','DD/MM/YYYY') AND X.FECAJU<=TO_DATE('09/02/2012','DD/MM/YYYY') and (X.STAAJU='A' OR (X.STAAJU='N' AND X.FECANU>=TO_DATE('09/02/2012','DD/MM/YYYY')))) as Ajuste,

                (B.monimp-B.monaju)as Mon_Aju, c.nomben,         a.moncom as monto
                FROM
                "SIMA005".CPCOMPRO as A left outer join "SIMA005".opbenefi C on A.CEDRIF=C.CEDRIF,
                "SIMA005".CPIMPCOM as B,
                "SIMA005".CPDOCCOM as D
                WHERE
                A.TIPCOM=D.TIPCOM AND RTRIM(D.AFECOM)='S'
                AND A.REFCOM = B.REFCOM
                AND (RTRIM(A.TIPCOM) >= RTRIM('BTN') AND RTRIM(A.TIPCOM) <= RTRIM('VIAT'))
                AND (A.REFCOM)>=RTRIM('00000001')  AND (A.REFCOM) <=RTRIM('OS000037')
                AND (B.CODPRE >=RTRIM('1-01-005-4-01-01-01-00-00') AND B.CODPRE<=RTRIM('4-01-008-4-07-01-01-12-00'))
                 AND A.FECCOM>=to_date('02/01/2012','dd/mm/yyyy') AND A.FECCOM <=to_date('09/02/2012','dd/mm/yyyy') AND (A.STACOM='A' OR (A.STACOM='N' AND A.FECANU>=to_date('09/02/2012','dd/mm/yyyy'))) 

                UNION
                SELECT
                A.refcau as referencia,
                RTRIM(A.descau)as descripcion,
                A.tipcau as tipo,
                to_char(A.feccau,'dd/mm/yyyy') as fecha,
                A.CEDRIF as cedrif,
                a.stacau as estat,
                RTRIM(B.CodPre ) as codigo,
                B.monimp as imputado,
                B.monimp as comprometido,
                B.monIMP as causado,
(SELECT SUM(S.MONIMP) FROM "SIMA005".CPpagos R,"SIMA005".CPimppag S WHERE S.REFere=B.REFCau AND S.CODPRE=B.CODPRE AND S.REFpag=R.REFpag AND  R.FECpag>=TO_DATE('02/01/2012','DD/MM/YYYY') AND R.FECpag<=TO_DATE('09/02/2012','DD/MM/YYYY') and (R.STApag='A' OR (R.STApag='N' AND R.FECANU>=TO_DATE('09/02/2012','DD/MM/YYYY')))) as pagado,				
(SELECT SUM(Y.MONAJU) FROM "SIMA005".CPAJUSTE X,"SIMA005".CPMOVAJU Y,"SIMA005".CPDOCAJU Z WHERE X.REFERE=B.REFCAU AND Y.CODPRE=B.CODPRE AND X.REFAJU=Y.REFAJU AND  X.TIPAJU=Z.TIPAJU AND Z.REFIER='A' AND X.FECAJU>=TO_DATE('02/01/2012','DD/MM/YYYY') AND X.FECAJU<=TO_DATE('09/02/2012','DD/MM/YYYY') and (X.STAAJU='A' OR (X.STAAJU='N' AND X.FECANU>=TO_DATE('09/02/2012','DD/MM/YYYY')))) as Ajuste,

                (B.monimp-B.monaju) as Mon_Aju, c.nomben, a.moncau as monto
                FROM
                "SIMA005".CPCAUSAD as A left outer join "SIMA005".opbenefi C on A.CEDRIF=C.CEDRIF,
                "SIMA005".CPIMPCAU as B,
                "SIMA005".CPDOCCAU as D
                WHERE
                A.TIPCAU=D.TIPCAU AND RTRIM(D.AFECOM)='S'
                AND A.REFCAU = B.REFCAU
                AND (RTRIM(A.TIPCAU) >=  RTRIM('BTN') AND RTRIM(A.TIPCAU) <=  RTRIM('VIAT'))
                AND (A.REFCAU)>=RTRIM('00000001') AND (A.REFCAU) <=RTRIM('OS000037')
                AND (B.CODPRE >=RTRIM('1-01-005-4-01-01-01-00-00') AND B.CODPRE<=RTRIM('4-01-008-4-07-01-01-12-00'))
                 AND A.FECCAU>=to_date('02/01/2012','dd/mm/yyyy') AND A.FECCAU <=to_date('09/02/2012','dd/mm/yyyy') AND (A.STACAU='A' OR (A.STACAU='N' AND A.FECANU>=to_date('09/02/2012','dd/mm/yyyy'))) 

                UNION
                SELECT
                A.refpag as referencia,
                RTRIM(A.despag)as descripcion,
                A.tippag as tipo,
                to_char(A.fecpag,'dd/mm/yyyy') as fecha,
                A.CEDRIF as cedrif,
                a.stapag as estat,
                RTRIM(B.CodPre ) as codigo,
                B.monimp as imputado,
                B.monimp as comprometido,
                B.monIMP as causado,
                B.monIMP as pagado,
(SELECT SUM(Y.MONAJU) FROM "SIMA005".CPAJUSTE X,"SIMA005".CPMOVAJU Y,"SIMA005".CPDOCAJU Z WHERE X.REFERE=B.REFPAG AND Y.CODPRE=B.CODPRE AND X.REFAJU=Y.REFAJU AND  X.TIPAJU=Z.TIPAJU AND Z.REFIER='G' AND X.FECAJU>=TO_DATE('02/01/2012','DD/MM/YYYY') AND X.FECAJU<=TO_DATE('09/02/2012','DD/MM/YYYY') and (X.STAAJU='A' OR (X.STAAJU='N' AND X.FECANU>=TO_DATE('09/02/2012','DD/MM/YYYY')))) as Ajuste,

                (B.monimp-B.monaju) as Mon_Aju, c.nomben, a.monpag as monto
                FROM
                "SIMA005".CPPAGOS as A left outer join "SIMA005".opbenefi C on A.CEDRIF=C.CEDRIF,
                "SIMA005".CPIMPPAG as B,
                "SIMA005".CPDOCPAG as D
                WHERE
                A.TIPPAG=D.TIPPAG
                AND RTRIM(D.AFECOM)='S'
                AND A.REFPAG = B.REFPAG
                 AND (A.TIPPAG >=  RTRIM('BTN') AND RTRIM(A.TIPPAG) <=  RTRIM('VIAT'))
                AND (A.REFPAG)>=RTRIM('00000001') AND (A.REFPAG) <=RTRIM('OS000037')
                AND (B.CODPRE >=RTRIM('1-01-005-4-01-01-01-00-00') AND B.CODPRE<=RTRIM('4-01-008-4-07-01-01-12-00'))
                  AND A.FECPAG>=to_date('02/01/2012','dd/mm/yyyy') AND A.FECPAG <=to_date('09/02/2012','dd/mm/yyyy') AND (A.STAPAG='A' OR (A.STAPAG='N' AND A.FECANU>=to_date('09/02/2012','dd/mm/yyyy')))   ORDER BY fecha,referencia asc,codigo,estat
                ) as J left outer join "SIMA005".CPDEFTIT P on (RTRIM(J.CODIGO)=RTRIM(P.CODPRE))]]>
	</queryString>
	<field name="nompre" class="java.lang.String"/>
	<field name="referencia" class="java.lang.String"/>
	<field name="descripcion" class="java.lang.String"/>
	<field name="tipo" class="java.lang.String"/>
	<field name="fecha" class="java.lang.String"/>
	<field name="cedrif" class="java.lang.String"/>
	<field name="nomben" class="java.lang.String"/>
	<field name="estat" class="java.lang.String"/>
	<field name="codigo" class="java.lang.String"/>
	<field name="imputado" class="java.math.BigDecimal"/>
	<field name="comprometido" class="java.math.BigDecimal"/>
	<field name="causado" class="java.math.BigDecimal"/>
	<field name="pagado" class="java.math.BigDecimal"/>
	<field name="ajuste" class="java.math.BigDecimal"/>
	<field name="mon_aju" class="java.math.BigDecimal"/>
	<field name="monto" class="java.math.BigDecimal"/>
	<variable name="ajuste" class="java.lang.String">
		<variableExpression><![CDATA[($F{estat}.equals("A") ? "Activo" : "Inactivo")]]></variableExpression>
	</variable>
	<variable name="pagado_1" class="java.math.BigDecimal" calculation="Sum">
		<variableExpression><![CDATA[$F{pagado}]]></variableExpression>
	</variable>
	<variable name="comprometido_1" class="java.math.BigDecimal" calculation="Sum">
		<variableExpression><![CDATA[$F{comprometido}]]></variableExpression>
	</variable>
	<variable name="ajuste_1" class="java.math.BigDecimal" calculation="Sum">
		<variableExpression><![CDATA[$F{ajuste}]]></variableExpression>
	</variable>
	<variable name="ajuste_2" class="java.math.BigDecimal" calculation="Sum">
		<variableExpression><![CDATA[$F{ajuste}]]></variableExpression>
	</variable>
	<variable name="mon_aju_1" class="java.math.BigDecimal" calculation="Sum">
		<variableExpression><![CDATA[$F{mon_aju}]]></variableExpression>
	</variable>
	<variable name="causado_1" class="java.math.BigDecimal" calculation="Sum">
		<variableExpression><![CDATA[$F{causado}]]></variableExpression>
	</variable>
	<variable name="pagado_2" class="java.math.BigDecimal" calculation="Sum">
		<variableExpression><![CDATA[$F{pagado}]]></variableExpression>
	</variable>
	<group name="Refgroup">
		<groupExpression><![CDATA[$F{referencia}]]></groupExpression>
		<groupHeader>
			<band height="50">
				<textField>
					<reportElement x="10" y="5" width="100" height="20"/>
					<textElement>
						<font isBold="true"/>
					</textElement>
					<textFieldExpression><![CDATA[$F{referencia}]]></textFieldExpression>
				</textField>
				<textField>
					<reportElement x="254" y="5" width="145" height="45"/>
					<textElement>
						<font isBold="true"/>
					</textElement>
					<textFieldExpression><![CDATA[$F{descripcion}]]></textFieldExpression>
				</textField>
				<textField>
					<reportElement x="95" y="5" width="125" height="20"/>
					<textElement>
						<font isBold="true"/>
					</textElement>
					<textFieldExpression><![CDATA[$F{tipo}]]></textFieldExpression>
				</textField>
				<textField>
					<reportElement x="177" y="5" width="77" height="20"/>
					<textElement>
						<font isBold="true"/>
					</textElement>
					<textFieldExpression><![CDATA[$F{fecha}]]></textFieldExpression>
				</textField>
				<textField>
					<reportElement x="408" y="5" width="225" height="20"/>
					<textElement>
						<font isBold="true"/>
					</textElement>
					<textFieldExpression><![CDATA[$F{nomben}]]></textFieldExpression>
				</textField>
				<textField>
					<reportElement x="665" y="0" width="87" height="20"/>
					<textElement textAlignment="Center" verticalAlignment="Middle">
						<font isBold="true"/>
					</textElement>
					<textFieldExpression><![CDATA[$F{estat}.equals("A") ? "Activo" : "Anulado"]]></textFieldExpression>
				</textField>
			</band>
		</groupHeader>
		<groupFooter>
			<band height="27">
				<textField>
					<reportElement x="399" y="0" width="66" height="20"/>
					<textElement textAlignment="Center" verticalAlignment="Middle"/>
					<textFieldExpression><![CDATA[$F{comprometido}==null ? 0.00 : $F{comprometido}]]></textFieldExpression>
				</textField>
				<textField>
					<reportElement x="465" y="0" width="68" height="20"/>
					<textElement textAlignment="Center" verticalAlignment="Middle"/>
					<textFieldExpression><![CDATA[$F{ajuste}==null ? 0.00 : $F{ajuste}]]></textFieldExpression>
				</textField>
				<textField>
					<reportElement x="533" y="0" width="82" height="20"/>
					<textElement textAlignment="Center" verticalAlignment="Middle"/>
					<textFieldExpression><![CDATA[$F{mon_aju}==null ? 0.00 : $F{mon_aju}]]></textFieldExpression>
				</textField>
				<textField>
					<reportElement x="615" y="0" width="70" height="20"/>
					<textElement textAlignment="Center" verticalAlignment="Middle"/>
					<textFieldExpression><![CDATA[$F{causado}==null ? 0.00 : $F{causado}]]></textFieldExpression>
				</textField>
				<textField>
					<reportElement x="685" y="0" width="56" height="20"/>
					<textElement textAlignment="Center" verticalAlignment="Middle"/>
					<textFieldExpression><![CDATA[$F{pagado}==null ? 0.00 : $F{pagado}]]></textFieldExpression>
				</textField>
				<staticText>
					<reportElement x="350" y="0" width="58" height="20"/>
					<textElement textAlignment="Center" verticalAlignment="Middle"/>
					<text><![CDATA[MONTO:]]></text>
				</staticText>
				<line>
					<reportElement x="10" y="20" width="731" height="1"/>
				</line>
			</band>
		</groupFooter>
	</group>
	<background>
		<band splitType="Stretch"/>
	</background>
	<pageHeader>
		<band height="130" splitType="Stretch">
			<image>
				<reportElement x="0" y="0" width="95" height="83"/>
				<imageExpression><![CDATA[$P{p_dirbase} + "img/logo.jpg"]]></imageExpression>
			</image>
			<textField>
				<reportElement x="0" y="83" width="752" height="33"/>
				<textElement textAlignment="Center" verticalAlignment="Middle">
					<font size="14" isBold="true"/>
				</textElement>
				<textFieldExpression><![CDATA[$P{p_titulo}]]></textFieldExpression>
			</textField>
			<textField>
				<reportElement x="595" y="27" width="100" height="20"/>
				<textElement textAlignment="Right">
					<font size="12" isBold="true"/>
				</textElement>
				<textFieldExpression><![CDATA["Página: "+$V{PAGE_NUMBER}+" de "]]></textFieldExpression>
			</textField>
			<textField evaluationTime="Report">
				<reportElement x="701" y="27" width="40" height="20"/>
				<textElement>
					<font size="12" isBold="true"/>
				</textElement>
				<textFieldExpression><![CDATA[" " + $V{PAGE_NUMBER}]]></textFieldExpression>
			</textField>
			<staticText>
				<reportElement x="95" y="0" width="339" height="20"/>
				<textElement>
					<font size="16" isBold="true"/>
				</textElement>
				<text><![CDATA[República Bolivariana de Venezuela]]></text>
			</staticText>
			<staticText>
				<reportElement x="95" y="17" width="273" height="20"/>
				<textElement>
					<font size="12" isBold="true"/>
				</textElement>
				<text><![CDATA[La Nueva Televisión del Sur c.a]]></text>
			</staticText>
			<staticText>
				<reportElement x="595" y="10" width="51" height="20"/>
				<textElement>
					<font size="12" isBold="true"/>
				</textElement>
				<text><![CDATA[Fecha:]]></text>
			</staticText>
			<textField pattern="dd/MM/yyyy">
				<reportElement x="646" y="10" width="100" height="20"/>
				<textElement>
					<font size="12" isBold="true"/>
				</textElement>
				<textFieldExpression><![CDATA[new java.util.Date()]]></textFieldExpression>
			</textField>
			<line>
				<reportElement x="10" y="123" width="731" height="1"/>
			</line>
		</band>
	</pageHeader>
	<columnHeader>
		<band height="50" splitType="Stretch">
			<staticText>
				<reportElement x="15" y="0" width="61" height="20"/>
				<textElement>
					<font isBold="true"/>
				</textElement>
				<text><![CDATA[Referencia]]></text>
			</staticText>
			<staticText>
				<reportElement x="254" y="0" width="100" height="20"/>
				<textElement>
					<font isBold="true"/>
				</textElement>
				<text><![CDATA[Descripción]]></text>
			</staticText>
			<staticText>
				<reportElement x="95" y="0" width="32" height="20"/>
				<textElement>
					<font isBold="true"/>
				</textElement>
				<text><![CDATA[Tipo]]></text>
			</staticText>
			<staticText>
				<reportElement x="177" y="0" width="37" height="20"/>
				<textElement>
					<font isBold="true"/>
				</textElement>
				<text><![CDATA[Fecha]]></text>
			</staticText>
			<staticText>
				<reportElement x="95" y="24" width="197" height="20"/>
				<textElement>
					<font isBold="true"/>
				</textElement>
				<text><![CDATA[Imputaciones Presupuestarias:]]></text>
			</staticText>
			<staticText>
				<reportElement x="533" y="0" width="100" height="20"/>
				<textElement>
					<font isBold="true"/>
				</textElement>
				<text><![CDATA[Beneficiario:]]></text>
			</staticText>
			<staticText>
				<reportElement x="384" y="24" width="357" height="20"/>
				<textElement>
					<font isBold="true"/>
				</textElement>
				<text><![CDATA[Comprometido  Ajustado   Monto Ajustado   Causado   Pagado ]]></text>
			</staticText>
			<line>
				<reportElement x="10" y="43" width="731" height="1"/>
			</line>
			<staticText>
				<reportElement x="685" y="0" width="48" height="20"/>
				<textElement>
					<font isBold="true"/>
				</textElement>
				<text><![CDATA[Estatus]]></text>
			</staticText>
		</band>
	</columnHeader>
	<detail>
		<band height="41" splitType="Stretch">
			<textField>
				<reportElement x="139" y="5" width="245" height="20"/>
				<textElement textAlignment="Center" verticalAlignment="Middle"/>
				<textFieldExpression><![CDATA[$F{nompre}]]></textFieldExpression>
			</textField>
			<line>
				<reportElement x="408" y="25" width="333" height="1"/>
			</line>
			<textField>
				<reportElement x="27" y="5" width="100" height="20"/>
				<textElement textAlignment="Center" verticalAlignment="Middle"/>
				<textFieldExpression><![CDATA[$F{codigo}]]></textFieldExpression>
			</textField>
			<textField>
				<reportElement x="399" y="5" width="66" height="20"/>
				<textElement textAlignment="Center" verticalAlignment="Middle"/>
				<textFieldExpression><![CDATA[$F{comprometido}==null ? 0.00 : $F{comprometido}]]></textFieldExpression>
			</textField>
			<textField>
				<reportElement x="465" y="5" width="68" height="20"/>
				<textElement textAlignment="Center" verticalAlignment="Middle"/>
				<textFieldExpression><![CDATA[$F{ajuste}==null ? 0.00 : $F{ajuste}]]></textFieldExpression>
			</textField>
			<textField>
				<reportElement x="533" y="5" width="82" height="20"/>
				<textElement textAlignment="Center" verticalAlignment="Middle"/>
				<textFieldExpression><![CDATA[$F{mon_aju}==null ? 0.00 : $F{mon_aju}]]></textFieldExpression>
			</textField>
			<textField>
				<reportElement x="615" y="5" width="70" height="20"/>
				<textElement textAlignment="Center" verticalAlignment="Middle"/>
				<textFieldExpression><![CDATA[$F{causado}==null ? 0.00 : $F{causado}]]></textFieldExpression>
			</textField>
			<textField>
				<reportElement x="685" y="5" width="56" height="20"/>
				<textElement textAlignment="Center" verticalAlignment="Middle"/>
				<textFieldExpression><![CDATA[$F{pagado}==null ? 0.00 : $F{pagado}]]></textFieldExpression>
			</textField>
		</band>
	</detail>
	<summary>
		<band height="52" splitType="Stretch">
			<staticText>
				<reportElement x="162" y="12" width="58" height="20"/>
				<textElement textAlignment="Center" verticalAlignment="Middle">
					<font isBold="true"/>
				</textElement>
				<text><![CDATA[TOTALES:]]></text>
			</staticText>
			<textField>
				<reportElement x="254" y="31" width="100" height="20"/>
				<textElement textAlignment="Center" verticalAlignment="Middle"/>
				<textFieldExpression><![CDATA[$V{comprometido_1}==null ? 0.00 : $V{comprometido_1}]]></textFieldExpression>
			</textField>
			<textField>
				<reportElement x="353" y="32" width="100" height="20"/>
				<textElement textAlignment="Center" verticalAlignment="Middle"/>
				<textFieldExpression><![CDATA[$V{ajuste_2}==null ? 0.00 : $V{ajuste_2}]]></textFieldExpression>
			</textField>
			<textField>
				<reportElement x="453" y="32" width="100" height="20"/>
				<textElement textAlignment="Center" verticalAlignment="Middle"/>
				<textFieldExpression><![CDATA[$V{mon_aju_1}==null ? 0.00 : $V{mon_aju_1}]]></textFieldExpression>
			</textField>
			<textField>
				<reportElement x="553" y="32" width="100" height="20"/>
				<textElement textAlignment="Center" verticalAlignment="Middle"/>
				<textFieldExpression><![CDATA[$V{causado_1}==null ? 0.00 : $V{causado_1}]]></textFieldExpression>
			</textField>
			<textField>
				<reportElement x="652" y="32" width="100" height="20"/>
				<textElement textAlignment="Center" verticalAlignment="Middle"/>
				<textFieldExpression><![CDATA[$V{pagado_2}==null ? 0.00 : $V{pagado_2}]]></textFieldExpression>
			</textField>
			<staticText>
				<reportElement x="250" y="12" width="491" height="20"/>
				<textElement>
					<font isBold="true"/>
				</textElement>
				<text><![CDATA[Comprometido          Ajustado           Monto Ajustado           Causado              Pagado ]]></text>
			</staticText>
		</band>
	</summary>
</jasperReport>
